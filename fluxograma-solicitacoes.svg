<svg width="1200" height="2000" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <style>
      .box { fill: #f8f9fa; stroke: #007bff; stroke-width: 2; rx: 8; }
      .decision { fill: #fff3cd; stroke: #ffc107; stroke-width: 2; }
      .process { fill: #d1ecf1; stroke: #17a2b8; stroke-width: 2; rx: 8; }
      .endpoint { fill: #d4edda; stroke: #28a745; stroke-width: 2; rx: 8; }
      .database { fill: #f8d7da; stroke: #dc3545; stroke-width: 2; rx: 8; }
      .notification { fill: #e2e3e5; stroke: #6c757d; stroke-width: 2; rx: 8; }
      .text { font-family: Arial, sans-serif; font-size: 12px; text-anchor: middle; }
      .title { font-family: Arial, sans-serif; font-size: 14px; font-weight: bold; text-anchor: middle; }
      .arrow { stroke: #333; stroke-width: 2; fill: none; marker-end: url(#arrowhead); }
      .arrow-yes { stroke: #28a745; stroke-width: 2; fill: none; marker-end: url(#arrowhead-green); }
      .arrow-no { stroke: #dc3545; stroke-width: 2; fill: none; marker-end: url(#arrowhead-red); }
    </style>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#333" />
    </marker>
    <marker id="arrowhead-green" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#28a745" />
    </marker>
    <marker id="arrowhead-red" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#dc3545" />
    </marker>
  </defs>
  
  <!-- Título -->
  <text x="600" y="30" class="title" font-size="18" fill="#333">Fluxograma do Sistema de Solicitações de Acesso</text>
  
  <!-- 1. Início - Usuário acessa formulário -->
  <rect x="500" y="60" width="200" height="50" class="box"/>
  <text x="600" y="80" class="text">Usuário acessa</text>
  <text x="600" y="95" class="text">/solicitacoes/nova</text>
  
  <!-- Seta -->
  <line x1="600" y1="110" x2="600" y2="140" class="arrow"/>
  
  <!-- 2. Controller exibe formulário -->
  <rect x="480" y="140" width="240" height="50" class="endpoint"/>
  <text x="600" y="160" class="text">SolicitacoesController</text>
  <text x="600" y="175" class="text">@GetMapping("/nova")</text>
  
  <!-- Seta -->
  <line x1="600" y1="190" x2="600" y2="220" class="arrow"/>
  
  <!-- 3. Template nova.html -->
  <rect x="500" y="220" width="200" height="50" class="process"/>
  <text x="600" y="240" class="text">Renderiza template</text>
  <text x="600" y="255" class="text">nova.html</text>
  
  <!-- Seta -->
  <line x1="600" y1="270" x2="600" y2="300" class="arrow"/>
  
  <!-- 4. Usuário preenche formulário -->
  <rect x="480" y="300" width="240" height="70" class="box"/>
  <text x="600" y="320" class="text">Usuário preenche:</text>
  <text x="600" y="335" class="text">• Colaborador, Módulos</text>
  <text x="600" y="350" class="text">• Justificativa, Prioridade</text>
  <text x="600" y="365" class="text">• Tipo de usuário</text>
  
  <!-- Seta -->
  <line x1="600" y1="370" x2="600" y2="400" class="arrow"/>
  
  <!-- 5. Submit do formulário -->
  <rect x="500" y="400" width="200" height="50" class="endpoint"/>
  <text x="600" y="420" class="text">POST /solicitacoes</text>
  <text x="600" y="435" class="text">criarSolicitacao()</text>
  
  <!-- Seta -->
  <line x1="600" y1="450" x2="600" y2="480" class="arrow"/>
  
  <!-- 6. Validação JavaScript -->
  <polygon points="550,480 650,480 675,505 650,530 550,530 525,505" class="decision"/>
  <text x="600" y="500" class="text">Validação JS</text>
  <text x="600" y="515" class="text">OK?</text>
  
  <!-- Seta NÃO -->
  <line x1="525" y1="505" x2="450" y2="505" class="arrow-no"/>
  <rect x="350" y="480" width="100" height="50" class="box"/>
  <text x="400" y="500" class="text">Exibe erro</text>
  <text x="400" y="515" class="text">no frontend</text>
  
  <!-- Seta SIM -->
  <line x1="600" y1="530" x2="600" y2="560" class="arrow-yes"/>
  
  <!-- 7. Service - Validação Backend -->
  <rect x="480" y="560" width="240" height="50" class="process"/>
  <text x="600" y="580" class="text">SolicitacaoAcessoService</text>
  <text x="600" y="595" class="text">validarSolicitacao()</text>
  
  <!-- Seta -->
  <line x1="600" y1="610" x2="600" y2="640" class="arrow"/>
  
  <!-- 8. Verificação de solicitação pendente -->
  <polygon points="520,640 680,640 705,665 680,690 520,690 495,665" class="decision"/>
  <text x="600" y="660" class="text">Colaborador já tem</text>
  <text x="600" y="675" class="text">solicitação pendente?</text>
  
  <!-- Seta SIM -->
  <line x1="705" y1="665" x2="780" y2="665" class="arrow-yes"/>
  <rect x="780" y="640" width="150" height="50" class="box"/>
  <text x="855" y="660" class="text">Retorna erro:</text>
  <text x="855" y="675" class="text">"Já existe solicitação"</text>
  
  <!-- Seta NÃO -->
  <line x1="600" y1="690" x2="600" y2="720" class="arrow-no"/>
  
  <!-- 9. Geração de protocolo -->
  <rect x="500" y="720" width="200" height="50" class="process"/>
  <text x="600" y="740" class="text">@PrePersist</text>
  <text x="600" y="755" class="text">Gera protocolo único</text>
  
  <!-- Seta -->
  <line x1="600" y1="770" x2="600" y2="800" class="arrow"/>
  
  <!-- 10. Salvamento no banco -->
  <rect x="500" y="800" width="200" height="50" class="database"/>
  <text x="600" y="820" class="text">Repository.save()</text>
  <text x="600" y="835" class="text">Status: PENDENTE</text>
  
  <!-- Seta -->
  <line x1="600" y1="850" x2="600" y2="880" class="arrow"/>
  
  <!-- 11. Notificação -->
  <rect x="480" y="880" width="240" height="50" class="notification"/>
  <text x="600" y="900" class="text">NotificationService</text>
  <text x="600" y="915" class="text">Notifica aprovadores</text>
  
  <!-- Seta -->
  <line x1="600" y1="930" x2="600" y2="960" class="arrow"/>
  
  <!-- 12. Redirecionamento -->
  <rect x="500" y="960" width="200" height="50" class="endpoint"/>
  <text x="600" y="980" class="text">Redirect para</text>
  <text x="600" y="995" class="text">/solicitacoes/minhas</text>
  
  <!-- Divisor -->
  <line x1="50" y1="1040" x2="1150" y2="1040" stroke="#666" stroke-width="2" stroke-dasharray="5,5"/>
  <text x="600" y="1060" class="title" font-size="16" fill="#666">FLUXO DE APROVAÇÃO</text>
  
  <!-- 13. Aprovador acessa lista -->
  <rect x="500" y="1080" width="200" height="50" class="box"/>
  <text x="600" y="1100" class="text">Aprovador acessa</text>
  <text x="600" y="1115" class="text">/solicitacoes</text>
  
  <!-- Seta -->
  <line x1="600" y1="1130" x2="600" y2="1160" class="arrow"/>
  
  <!-- 14. Lista solicitações pendentes -->
  <rect x="480" y="1160" width="240" height="50" class="endpoint"/>
  <text x="600" y="1180" class="text">GET /solicitacoes</text>
  <text x="600" y="1195" class="text">Status: PENDENTE</text>
  
  <!-- Seta -->
  <line x1="600" y1="1210" x2="600" y2="1240" class="arrow"/>
  
  <!-- 15. Clica em aprovar -->
  <rect x="500" y="1240" width="200" height="50" class="box"/>
  <text x="600" y="1260" class="text">Clica em "Aprovar"</text>
  <text x="600" y="1275" class="text">ou "Ver detalhes"</text>
  
  <!-- Seta -->
  <line x1="600" y1="1290" x2="600" y2="1320" class="arrow"/>
  
  <!-- 16. Formulário de aprovação -->
  <rect x="480" y="1320" width="240" height="50" class="endpoint"/>
  <text x="600" y="1340" class="text">GET /solicitacoes/aprovar/{id}</text>
  <text x="600" y="1355" class="text">Template: aprovar.html</text>
  
  <!-- Seta -->
  <line x1="600" y1="1370" x2="600" y2="1400" class="arrow"/>
  
  <!-- 17. Decisão do aprovador -->
  <polygon points="520,1400 680,1400 705,1425 680,1450 520,1450 495,1425" class="decision"/>
  <text x="600" y="1420" class="text">Aprovador decide:</text>
  <text x="600" y="1435" class="text">Aprovar ou Rejeitar?</text>
  
  <!-- Seta APROVAR -->
  <line x1="520" y1="1425" x2="350" y2="1425" class="arrow-yes"/>
  <rect x="200" y="1400" width="150" height="70" class="process"/>
  <text x="275" y="1420" class="text">APROVAR</text>
  <text x="275" y="1435" class="text">• Define nível acesso</text>
  <text x="275" y="1450" class="text">• Email corporativo</text>
  <text x="275" y="1465" class="text">• Observações</text>
  
  <!-- Seta REJEITAR -->
  <line x1="680" y1="1425" x2="850" y2="1425" class="arrow-no"/>
  <rect x="850" y="1400" width="150" height="50" class="process"/>
  <text x="925" y="1420" class="text">REJEITAR</text>
  <text x="925" y="1435" class="text">• Motivo obrigatório</text>
  
  <!-- Setas convergindo -->
  <line x1="275" y1="1470" x2="275" y2="1520" class="arrow"/>
  <line x1="925" y1="1450" x2="925" y2="1520" class="arrow"/>
  <line x1="275" y1="1520" x2="600" y2="1520" class="arrow"/>
  <line x1="925" y1="1520" x2="600" y2="1520" class="arrow"/>
  
  <!-- 18. Processamento da decisão -->
  <rect x="480" y="1540" width="240" height="50" class="endpoint"/>
  <text x="600" y="1560" class="text">POST /solicitacoes/aprovar/{id}</text>
  <text x="600" y="1575" class="text">processarAprovacao()</text>
  
  <!-- Seta -->
  <line x1="600" y1="1590" x2="600" y2="1620" class="arrow"/>
  
  <!-- 19. Atualização no banco -->
  <rect x="480" y="1620" width="240" height="70" class="database"/>
  <text x="600" y="1640" class="text">Atualiza SolicitacaoAcesso:</text>
  <text x="600" y="1655" class="text">• Status: APROVADO/REJEITADO</text>
  <text x="600" y="1670" class="text">• Data aprovação</text>
  <text x="600" y="1685" class="text">• Aprovador, observações</text>
  
  <!-- Seta -->
  <line x1="600" y1="1690" x2="600" y2="1720" class="arrow"/>
  
  <!-- 20. Notificações -->
  <rect x="480" y="1720" width="240" height="50" class="notification"/>
  <text x="600" y="1740" class="text">Notifica solicitante</text>
  <text x="600" y="1755" class="text">e administradores</text>
  
  <!-- Divisor -->
  <line x1="50" y1="1800" x2="1150" y2="1800" stroke="#666" stroke-width="2" stroke-dasharray="5,5"/>
  <text x="600" y="1820" class="title" font-size="16" fill="#666">CRIAÇÃO DE USUÁRIO (Se aprovado)</text>
  
  <!-- 21. TI acessa solicitação aprovada -->
  <rect x="500" y="1840" width="200" height="50" class="box"/>
  <text x="600" y="1860" class="text">TI acessa solicitação</text>
  <text x="600" y="1875" class="text">aprovada</text>
  
  <!-- Seta -->
  <line x1="600" y1="1890" x2="600" y2="1920" class="arrow"/>
  
  <!-- 22. Botão criar usuário -->
  <rect x="480" y="1920" width="240" height="50" class="endpoint"/>
  <text x="600" y="1940" class="text">POST /solicitacoes/criar-usuario/{id}</text>
  <text x="600" y="1955" class="text">criarUsuarioAposAprovacao()</text>
  
  <!-- Seta -->
  <line x1="600" y1="1970" x2="600" y2="2000" class="arrow"/>
  
  <!-- 23. Criação do usuário -->
  <rect x="480" y="2000" width="240" height="70" class="database"/>
  <text x="600" y="2020" class="text">Cria novo Usuario:</text>
  <text x="600" y="2035" class="text">• Email, senha temporária</text>
  <text x="600" y="2050" class="text">• Nível de acesso aprovado</text>
  <text x="600" y="2065" class="text">• Status: USUARIO_CRIADO</text>
  
  <!-- Legenda -->
  <rect x="50" y="1850" width="300" height="120" fill="#f8f9fa" stroke="#dee2e6" stroke-width="1" rx="5"/>
  <text x="200" y="1870" class="title" font-size="14">Legenda:</text>
  <rect x="60" y="1880" width="15" height="10" class="box"/>
  <text x="85" y="1890" class="text" text-anchor="start">Interface/Formulário</text>
  <rect x="60" y="1900" width="15" height="10" class="endpoint"/>
  <text x="85" y="1910" class="text" text-anchor="start">Controller/Endpoint</text>
  <rect x="60" y="1920" width="15" height="10" class="process"/>
  <text x="85" y="1930" class="text" text-anchor="start">Service/Processamento</text>
  <rect x="60" y="1940" width="15" height="10" class="database"/>
  <text x="85" y="1950" class="text" text-anchor="start">Banco de Dados</text>
  <rect x="60" y="1960" width="15" height="10" class="notification"/>
  <text x="85" y="1970" class="text" text-anchor="start">Notificação</text>
  
</svg>