<!DOCTYPE html>
<html lang="pt-BR" xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/app}">
<head>
    <title>Dashboard RH - ERP Corporativo</title>
    <style>
        .dashboard-card {
            border: none;
            border-radius: 15px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .dashboard-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.2);
        }
        .card-icon {
            font-size: 3rem;
            margin-bottom: 15px;
        }
        .btn-dashboard {
            border-radius: 10px;
            padding: 12px 24px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
    </style>
</head>

<body>
    <div layout:fragment="content" class="container-fluid">
        <!-- Header -->
        <div class="row mb-4">
            <div class="col-12">
                <div class="d-flex justify-content-between align-items-center">
                    <div>
                        <h1 class="h3 mb-0 text-gray-800">
                            <i class="fas fa-users text-primary me-2"></i>
                            Dashboard - Recursos Humanos
                        </h1>
                        <p class="text-muted mb-0">Central de gestão de colaboradores e processos de RH</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Cards de Navegação Principal -->
        <div class="row g-4 mb-5">
            <!-- Gestão de Colaboradores -->
            <div class="col-md-6 col-lg-4">
                <div class="card dashboard-card h-100 border-left-primary">
                    <div class="card-body text-center">
                        <div class="card-icon text-primary">
                            <i class="fas fa-address-book"></i>
                        </div>
                        <h5 class="card-title">Gestão de Colaboradores</h5>
                        <p class="card-text text-muted">
                            Visualizar, editar e gerenciar colaboradores ativos
                        </p>
                        <div class="mt-3">
                            <a href="/rh/colaboradores/listar" class="btn btn-primary btn-dashboard me-2">
                                <i class="fas fa-list me-1"></i> Listar
                            </a>
                            <a href="/rh/colaboradores/novo" class="btn btn-outline-primary btn-dashboard">
                                <i class="fas fa-plus me-1"></i> Novo
                            </a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Processo de Adesão -->
            <div class="col-md-6 col-lg-4">
                <div class="card dashboard-card h-100 border-left-success">
                    <div class="card-body text-center">
                        <div class="card-icon text-success">
                            <i class="fas fa-user-plus"></i>
                        </div>
                        <h5 class="card-title">Adesão de Colaboradores</h5>
                        <p class="card-text text-muted">
                            Processo completo de admissão com aprovação
                        </p>
                        <div class="mt-3">
                            <a href="/rh/colaboradores/adesao" class="btn btn-success btn-dashboard me-2">
                                <i class="fas fa-play me-1"></i> Iniciar
                            </a>
                            <a href="/rh/workflow/processos" class="btn btn-outline-success btn-dashboard">
                                <i class="fas fa-tasks me-1"></i> Acompanhar
                            </a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Benefícios -->
            <div class="col-md-6 col-lg-4">
                <div class="card dashboard-card h-100 border-left-info">
                    <div class="card-body text-center">
                        <div class="card-icon text-info">
                            <i class="fas fa-gift"></i>
                        </div>
                        <h5 class="card-title">Benefícios</h5>
                        <p class="card-text text-muted">
                            Gestão de planos de saúde e vale-refeição
                        </p>
                        <div class="mt-3">
                            <a href="/rh/beneficios/vale-refeicao/listar" class="btn btn-info btn-dashboard me-2">
                                <i class="fas fa-utensils me-1"></i> V. Refeição
                            </a>
                            <a href="/rh/beneficios/adesao" class="btn btn-outline-info btn-dashboard">
                                <i class="fas fa-heart me-1"></i> Planos
                            </a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Folha de Pagamento -->
            <div class="col-md-6 col-lg-4">
                <div class="card dashboard-card h-100 border-left-warning">
                    <div class="card-body text-center">
                        <div class="card-icon text-warning">
                            <i class="fas fa-money-bill-wave"></i>
                        </div>
                        <h5 class="card-title">Folha de Pagamento</h5>
                        <p class="card-text text-muted">
                            Gestão de holerites e processamento mensal
                        </p>
                        <div class="mt-3">
                            <a href="/rh/folha-pagamento/gerar" class="btn btn-warning btn-dashboard me-2">
                                <i class="fas fa-calculator me-1"></i> Gerar
                            </a>
                            <a href="/rh/folha-pagamento/listar" class="btn btn-outline-warning btn-dashboard">
                                <i class="fas fa-list-alt me-1"></i> Histórico
                            </a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Controle de Ponto -->
            <div class="col-md-6 col-lg-4">
                <div class="card dashboard-card h-100 border-left-secondary">
                    <div class="card-body text-center">
                        <div class="card-icon text-secondary">
                            <i class="fas fa-clock"></i>
                        </div>
                        <h5 class="card-title">Controle de Ponto</h5>
                        <p class="card-text text-muted">
                            Registros de entrada/saída e escalas
                        </p>
                        <div class="mt-3">
                            <a href="/rh/ponto-escalas/registros" class="btn btn-secondary btn-dashboard me-2">
                                <i class="fas fa-fingerprint me-1"></i> Registros
                            </a>
                            <a href="/rh/ponto-escalas/escalas" class="btn btn-outline-secondary btn-dashboard">
                                <i class="fas fa-calendar-alt me-1"></i> Escalas
                            </a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Relatórios -->
            <div class="col-md-6 col-lg-4">
                <div class="card dashboard-card h-100 border-left-dark">
                    <div class="card-body text-center">
                        <div class="card-icon text-dark">
                            <i class="fas fa-chart-bar"></i>
                        </div>
                        <h5 class="card-title">Relatórios</h5>
                        <p class="card-text text-muted">
                            Análises e relatórios gerenciais
                        </p>
                        <div class="mt-3">
                            <a href="/rh/colaboradores/relatorio" class="btn btn-dark btn-dashboard me-2">
                                <i class="fas fa-users me-1"></i> Pessoal
                            </a>
                            <a href="/rh/workflow/relatorios" class="btn btn-outline-dark btn-dashboard">
                                <i class="fas fa-chart-line me-1"></i> Processos
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Seção de Status Rápido -->
        <div class="row">
            <div class="col-12">
                <div class="card">
                    <div class="card-header bg-primary text-white">
                        <h5 class="card-title mb-0">
                            <i class="fas fa-tachometer-alt me-2"></i>
                            Status Rápido
                        </h5>
                    </div>
                    <div class="card-body">
                        <div class="row text-center">
                            <div class="col-md-3">
                                <div class="border-end">
                                    <h3 class="text-primary mb-1">
                                        <i class="fas fa-users"></i>
                                        <span id="totalColaboradores">-</span>
                                    </h3>
                                    <p class="text-muted mb-0">Colaboradores Ativos</p>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="border-end">
                                    <h3 class="text-success mb-1">
                                        <i class="fas fa-user-check"></i>
                                        <span id="novosColaboradores">-</span>
                                    </h3>
                                    <p class="text-muted mb-0">Novos Este Mês</p>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="border-end">
                                    <h3 class="text-warning mb-1">
                                        <i class="fas fa-clock"></i>
                                        <span id="processosAprovacao" th:text="${processosAguardandoAprovacao ?: 0}">0</span>
                                    </h3>
                                    <p class="text-muted mb-0">Aguardando Aprovação</p>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <h3 class="text-success mb-1">
                                    <i class="fas fa-check-circle"></i>
                                    <span id="processosAprovados" th:text="${processosAprovados ?: 0}">0</span>
                                </h3>
                                <p class="text-muted mb-0">Processos Aprovados</p>
                            </div>
                        </div>
                        <div class="row text-center mt-3">
                            <div class="col-md-4">
                                <h3 class="text-danger mb-1">
                                    <i class="fas fa-times-circle"></i>
                                    <span id="processosRejeitados" th:text="${processosRejeitados ?: 0}">0</span>
                                </h3>
                                <p class="text-muted mb-0">Processos Rejeitados</p>
                            </div>
                            <div class="col-md-4">
                                <h3 class="text-info mb-1">
                                    <i class="fas fa-calendar-day"></i>
                                    <span id="processosHoje" th:text="${processosHoje ?: 0}">0</span>
                                </h3>
                                <p class="text-muted mb-0">Processos Hoje</p>
                            </div>
                            <div class="col-md-4">
                                <h3 class="text-info mb-1">
                                    <i class="fas fa-utensils"></i>
                                    <span id="valesAtivos" th:text="${valesAtivos ?: 0}">0</span>
                                </h3>
                                <p class="text-muted mb-0">Vales Refeição Ativos</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts adicionais -->
    <script layout:fragment="scripts">
        document.addEventListener('DOMContentLoaded', function() {
            // Dashboard RH carregado com estatísticas dos processos de adesão
            console.log('Dashboard RH carregado com métricas atualizadas dos processos de adesão');
            
            // Função para atualizar estatísticas em tempo real
            function atualizarEstatisticas() {
                fetch('/rh/api/processos-adesao/estatisticas')
                    .then(response => response.json())
                    .then(data => {
                        if (data.success) {
                             // Atualizar os valores na tela usando os IDs corretos
                             const aguardandoElement = document.querySelector('.card:nth-child(1) .card-body h3');
                             const aprovadosElement = document.querySelector('.card:nth-child(2) .card-body h3');
                             const rejeitadosElement = document.querySelector('.card:nth-child(3) .card-body h3');
                             const hojeElement = document.querySelector('.card:nth-child(4) .card-body h3');
                             
                             if (aguardandoElement) aguardandoElement.textContent = data.processosAguardandoAprovacao || 0;
                             if (aprovadosElement) aprovadosElement.textContent = data.processosAprovados || 0;
                             if (rejeitadosElement) rejeitadosElement.textContent = data.processosRejeitados || 0;
                             if (hojeElement) hojeElement.textContent = data.processosHoje || 0;
                            
                            console.log('Estatísticas atualizadas:', data);
                        } else {
                            console.error('Erro ao carregar estatísticas:', data.message);
                        }
                    })
                    .catch(error => {
                        console.error('Erro na requisição de estatísticas:', error);
                    });
            }
            
            // Atualizar estatísticas a cada 30 segundos
            setInterval(atualizarEstatisticas, 30000);
            
            // Atualizar uma vez ao carregar a página
            setTimeout(atualizarEstatisticas, 1000);
        });
    </script>
</body>
</html>