<!DOCTYPE html>
<html lang="pt-br" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chat Interno - ERP Corporativo</title>
    
    <!-- CSS padr√£o -->
    <link href="/css/style.css" rel="stylesheet">
    <link href="/css/sidebar.css" rel="stylesheet">
    <link href="/css/notifications.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Custom CSS -->
    <link href="/css/chat.css" rel="stylesheet">
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside th:replace="~{components/sidebar :: sidebar}"></aside>
        
        <!-- Main Content -->
        <main class="main-content">
            <!-- Topbar -->
            <header th:replace="~{components/topbar :: topbar}"></header>

            <!-- Conte√∫do da p√°gina Chat -->
            <section class="content-area">
                <div class="chat-container">
       

        <!-- Layout Principal -->
        <div class="chat-layout">
            
            <!-- Sidebar de Conversas (30%) -->
            <div class="conversations-sidebar">
                <!-- Barra de busca -->
                <div class="search-container">
                    <div class="input-group">
                        <span class="input-group-text">
                            <i class="fas fa-search"></i>
                        </span>
                        <input type="text" class="form-control" placeholder="Buscar conversas..." id="searchInput">
                        <div class="header-actions">
                    <span class="connection-status" id="connectionStatus">Conectando...</span>
                </div>
                    </div>
                </div>
                
                <!-- Bot√£o Nova Conversa -->
                <div class="new-conversation-container">
                    <button class="btn btn-primary w-100" id="newConversationBtn">
                        <i class="fas fa-plus me-2"></i>Nova Conversa
                    </button>
                </div>

                <!-- Lista de Conversas -->
                <div class="conversations-list" id="conversationsList">
                    
                    <!-- Exemplo de conversa individual -->
                    <div class="conversation-item" data-conversation-id="1" data-type="individual">
                        <div class="conversation-avatar">
                            <img src="/img/default-avatar.svg" alt="Maria Silva" class="avatar-img">
                            <span class="status-indicator status-online"></span>
                        </div>
                        <div class="conversation-info">
                            <div class="conversation-header">
                                <h6 class="conversation-name">Maria Silva</h6>
                                <span class="conversation-time">14:30</span>
                            </div>
                            <p class="conversation-preview">Perfeito! Sobre o equipamento? Notebook j√° est√° separado?</p>
                            <div class="conversation-meta">
                                <span class="participants-count">2 participantes</span>
                                <span class="unread-badge">3</span>
                            </div>
                        </div>
                    </div>

                    <!-- Exemplo de conversa de grupo -->
                    <div class="conversation-item" data-conversation-id="2" data-type="group">
                        <div class="conversation-avatar">
                            <div class="group-avatar">
                                <i class="fas fa-users"></i>
                            </div>
                            <span class="status-indicator status-typing"></span>
                        </div>
                        <div class="conversation-info">
                            <div class="conversation-header">
                                <h6 class="conversation-name">Equipe de TI</h6>
                                <span class="conversation-time">11:54</span>
                            </div>
                            <p class="conversation-preview">Deploy da vers√£o 2.1 conclu√≠do...</p>
                            <div class="conversation-meta">
                                <span class="participants-count">5 participantes</span>
                                <span class="conversation-type">Departamento</span>
                            </div>
                        </div>
                    </div>

                    <!-- Exemplo de conversa departamental -->
                    <div class="conversation-item" data-conversation-id="3" data-type="department">
                        <div class="conversation-avatar">
                            <div class="department-avatar">
                                DV
                            </div>
                            <span class="status-indicator status-offline"></span>
                        </div>
                        <div class="conversation-info">
                            <div class="conversation-header">
                                <h6 class="conversation-name">Departamento - Vendas</h6>
                                <span class="conversation-time">09:32</span>
                            </div>
                            <p class="conversation-preview">Meta do m√™s atingida! Muito obrigada pela agilidade! üòä</p>
                            <div class="conversation-meta">
                                <span class="participants-count">8 participantes</span>
                                <span class="conversation-type">Departamento</span>
                            </div>
                        </div>
                    </div>

                    <!-- Mais uma conversa -->
                    <div class="conversation-item" data-conversation-id="4" data-type="individual">
                        <div class="conversation-avatar">
                            <img src="/img/default-avatar.svg" alt="Ana Costa" class="avatar-img">
                            <span class="status-indicator status-online"></span>
                        </div>
                        <div class="conversation-info">
                            <div class="conversation-header">
                                <h6 class="conversation-name">Ana Costa</h6>
                                <span class="conversation-time">11:39</span>
                            </div>
                            <p class="conversation-preview">Preciso dos relat√≥rios financeiros...</p>
                            <div class="conversation-meta">
                                <span class="participants-count">2 participantes</span>
                                <span class="unread-badge">1</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- √Årea de Chat (70%) -->
            <div class="chat-area">
                <!-- Estado Inicial - Nenhuma conversa selecionada -->
                <div class="empty-state" id="emptyState">
                    <div class="empty-state-content">
                        <i class="fas fa-comments empty-icon"></i>
                        <h3>Selecione uma conversa</h3>
                        <p>Escolha uma conversa existente ou inicie uma nova para come√ßar a conversar.</p>
                    </div>
                </div>

                <!-- √Årea de Conversa Ativa -->
                <div class="active-chat" id="activeChat" style="display: none;">
                    <!-- Cabe√ßalho da Conversa -->
                    <div class="chat-header-area">
                        <div class="d-flex align-items-center">
                            <div class="chat-contact-avatar">
                                <img src="/img/default-avatar.svg" alt="Contato" class="avatar-img" id="chatContactAvatar">
                                <span class="status-indicator status-online" id="chatContactStatus"></span>
                            </div>
                            <div class="chat-contact-info">
                                <h5 class="chat-contact-name" id="chatContactName">Maria Silva</h5>
                                <span class="chat-contact-status" id="chatContactStatusText">2 online</span>
                            </div>
                        </div>
                        <div class="chat-actions">
                            <button class="btn btn-outline-secondary btn-sm" id="searchMessagesBtn">
                                <i class="fas fa-search"></i>
                            </button>
                            <button class="btn btn-outline-secondary btn-sm" id="chatOptionsBtn">
                                <i class="fas fa-ellipsis-v"></i>
                            </button>
                        </div>
                    </div>

                    <!-- √Årea de Mensagens -->
                    <div class="messages-area" id="messagesArea">
                        <!-- Exemplo de mensagens -->
                        <div class="message-group">
                            <div class="message received">
                                <div class="message-avatar">
                                    <img src="/img/default-avatar.svg" alt="Maria Silva" class="avatar-img">
                                </div>
                                <div class="message-content">
                                    <div class="message-header">
                                        <span class="sender-name">Maria Silva</span>
                                        <span class="sender-role">Analista de RH</span>
                                    </div>
                                    <div class="message-bubble">
                                        <p>Boa tarde! J√° tem acesso ao sistema?</p>
                                    </div>
                                    <div class="message-time">14:30</div>
                                </div>
                            </div>
                        </div>

                        <div class="message-group">
                            <div class="message sent">
                                <div class="message-content">
                                    <div class="message-bubble">
                                        <p>Ainda n√£o, preciso criar o usu√°rio dele no sistema. Vou providenciar hoje mesmo!</p>
                                    </div>
                                    <div class="message-time">
                                        <span>14:32</span>
                                        <i class="fas fa-check message-status"></i>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="message-group">
                            <div class="message received">
                                <div class="message-avatar">
                                    <img src="/img/default-avatar.svg" alt="Maria Silva" class="avatar-img">
                                </div>
                                <div class="message-content">
                                    <div class="message-header">
                                        <span class="sender-name">Maria Silva</span>
                                        <span class="sender-role">Analista de RH</span>
                                    </div>
                                    <div class="message-bubble">
                                        <p>Perfeito! Sobre o equipamento? Notebook j√° est√° separado?</p>
                                    </div>
                                    <div class="message-time">11:59</div>
                                </div>
                            </div>
                        </div>

                        <div class="message-group">
                            <div class="message sent">
                                <div class="message-content">
                                    <div class="message-bubble">
                                        <p>Sim, o Pedro j√° configurou tudo. Ser√° entregue amanh√£ pela manh√£.</p>
                                    </div>
                                    <div class="message-time">
                                        <span>12:04</span>
                                        <i class="fas fa-check-double message-status read"></i>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="message-group">
                            <div class="message received">
                                <div class="message-avatar">
                                    <img src="/img/default-avatar.svg" alt="Maria Silva" class="avatar-img">
                                </div>
                                <div class="message-content">
                                    <div class="message-header">
                                        <span class="sender-name">Maria Silva</span>
                                        <span class="sender-role">Analista de RH</span>
                                    </div>
                                    <div class="message-bubble">
                                        <p>√ìtimo! Ent√£o est√° tudo encaminhado. Muito obrigada pela agilidade! üòä</p>
                                    </div>
                                    <div class="message-time">12:09</div>
                                </div>
                            </div>
                        </div>

                        <div class="message-group">
                            <div class="message sent">
                                <div class="message-content">
                                    <div class="message-bubble">
                                        <p>Imagina! Qualquer coisa me chama üòä</p>
                                    </div>
                                    <div class="message-time">
                                        <span>12:14</span>
                                        <i class="fas fa-check-double message-status read"></i>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="message-group">
                            <div class="message received">
                                <div class="message-avatar">
                                    <img src="/img/default-avatar.svg" alt="Maria Silva" class="avatar-img">
                                </div>
                                <div class="message-content">
                                    <div class="message-header">
                                        <span class="sender-name">Maria Silva</span>
                                        <span class="sender-role">Analista de RH</span>
                                    </div>
                                    <div class="message-bubble">
                                        <p>Oi! Podemos conversar sobre o processo de admiss√£o do novo funcion√°rio?</p>
                                    </div>
                                    <div class="message-time">12:34</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Indicador de Digita√ß√£o -->
                    <div class="typing-indicator" id="typingIndicator" style="display: none;">
                        <div class="typing-content">
                            <div class="typing-avatar">
                                <img src="/img/default-avatar.svg" alt="Digitando" class="avatar-img">
                            </div>
                            <div class="typing-text">
                                <span id="typingUserName">Maria Silva</span> est√° digitando
                                <div class="typing-dots">
                                    <span></span>
                                    <span></span>
                                    <span></span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Status de Conex√£o -->
                    <div class="connection-status-container">
                        <span class="connection-status" id="connectionStatus">Conectando...</span>
                    </div>

                    <!-- √Årea de Entrada de Mensagem -->
                    <div class="message-input-area">
                        <div class="input-container">
                            <button class="btn btn-outline-secondary attachment-btn" id="attachmentBtn">
                                <i class="fas fa-paperclip"></i>
                            </button>
                            <button class="btn btn-outline-secondary emoji-btn" id="emojiBtn">
                                <i class="fas fa-smile"></i>
                            </button>
                            <div class="message-input-wrapper">
                                <textarea class="form-control message-input" id="messageInput" placeholder="Digite sua mensagem..." rows="1"></textarea>
                                <div class="input-hint">
                                    Enter para enviar, Shift+Enter para quebrar linha
                                </div>
                            </div>
                            <button class="btn btn-primary send-btn" id="sendButton">
                                <i class="fas fa-paper-plane"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

                </div>
            </section>

            <!-- Footer -->
            <footer th:replace="~{components/footer :: footer}"></footer>
        </main>
    </div>

    <!-- Modal para Nova Conversa -->
    <div class="modal fade" id="newConversationModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Nova Conversa</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <label for="userSearch" class="form-label">Buscar usu√°rio:</label>
                        <input type="text" class="form-control" id="userSearch" placeholder="Digite o nome do usu√°rio...">
                    </div>
                    <div class="users-list" id="usersList">
                        <!-- Lista de usu√°rios ser√° carregada aqui -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts padr√£o -->
    <script src="/js/sidebar.js" defer></script>
    <script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
    <script th:src="@{/js/notifications.js}"></script>
    
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- SockJS -->
    <script src="https://cdn.jsdelivr.net/npm/sockjs-client@1/dist/sockjs.min.js"></script>
    
    <!-- STOMP -->
    <script src="https://cdn.jsdelivr.net/npm/@stomp/stompjs@7.0.0/bundles/stomp.umd.min.js"></script>
    
    <!-- Chat JavaScript -->
    <script src="/js/chat.js"></script>
</body>

</html>