<div class="sidebar" th:fragment="sidebar">
  <div>
    <div class="user-panel">
      <img th:if="${usuarioLogado != null}" th:src="@{/usuarios/{id}/foto(id=${usuarioLogado.id})}"
        alt="Foto do usuário" class="user-avatar" />
      <div class="user-name" th:text="${usuarioLogado != null ? usuarioLogado.nome : 'Usuário'}">Nome do Usuário</div>
      <div class="user-level" th:text="${nivelAcesso}" style="font-size: 0.8em; color: #888; margin-top: 2px;">Nível de Acesso</div>
    </div>

    <nav>
      <ul>
        <!-- Itens comuns - essenciais -->
        <li><a href="/dashboard"><i class="fas fa-tachometer-alt"></i> Dashboard</a></li>

        <li>
          <a th:href="@{/usuarios/{id}/editar(id=${usuarioLogado.id})}">
            <i class="fas fa-user-cog"></i> Meu Perfil
          </a>
        </li>

        <!-- Itens operacionais básicos - todos podem acessar -->
        <li><a href="/clientes"><i class="fas fa-address-book"></i> Clientes</a></li>
        <li><a href="/vendas"><i class="fas fa-cash-register"></i> Vendas</a></li>
        <li><a href="/fornecedores"><i class="fas fa-handshake"></i> Fornecedores</a></li>
        <li><a href="/contratos"><i class="fas fa-file-contract"></i> Contratos</a></li>
        <li><a href="/produtos"><i class="fas fa-boxes"></i> Produtos</a></li>
        <li><a href="/estoque"><i class="fas fa-warehouse"></i> Estoque</a></li>
        
        <li class="has-submenu">
          <a href="javascript:void(0);" class="submenu-toggle">
            <i class="fas fa-tags"></i> Categorias <i class="fas fa-chevron-down submenu-icon"></i>
          </a>
          <ul class="submenu" style="display: none;">
            <li><a href="/categorias"><i class="fas fa-list"></i> Listar Categorias</a></li>
            <li><a href="/categorias/nova"><i class="fas fa-plus-circle"></i> Nova Categoria</a></li>
          </ul>
        </li>

        <!-- Módulo RH - Apenas níveis gerenciais ou específicos de RH -->
        <li class="has-submenu" th:if="${podeGerenciarRH or isGerencial}">
          <a href="javascript:void(0);" class="submenu-toggle">
            <i class="fas fa-users"></i> Recursos Humanos <i class="fas fa-chevron-down submenu-icon"></i>
          </a>
          <ul class="submenu" style="display: none;">
            <li class="has-submenu">
              <a href="javascript:void(0);" class="submenu-toggle">
                <i class="fas fa-user-tie"></i> Colaboradores <i class="fas fa-chevron-down submenu-icon"></i>
              </a>
              <ul class="submenu" style="display: none;">
                <li><a href="/rh/colaboradores/listar"><i class="fas fa-list"></i> Listar</a></li>
                <li th:if="${podeGerenciarRH}"><a href="/rh/colaboradores/novo"><i class="fas fa-plus"></i> Novo</a></li>
                <li><a href="/rh/colaboradores/ficha"><i class="fas fa-id-card"></i> Ficha</a></li>
                <li><a href="/rh/colaboradores/documentos"><i class="fas fa-file-alt"></i> Documentos</a></li>
                <li><a href="/rh/colaboradores/historico"><i class="fas fa-history"></i> Histórico</a></li>
              </ul>
            </li>
            
            <!-- Folha de Pagamento - Apenas RH e níveis superiores -->
            <li class="has-submenu" th:if="${podeGerenciarRH}">
              <a href="javascript:void(0);" class="submenu-toggle">
                <i class="fas fa-money-bill-wave"></i> Folha de Pagamento <i class="fas fa-chevron-down submenu-icon"></i>
              </a>
              <ul class="submenu" style="display: none;">
                <li><a href="/rh/folha-pagamento/gerar"><i class="fas fa-calculator"></i> Gerar</a></li>
                <li><a href="/rh/folha-pagamento/holerite"><i class="fas fa-receipt"></i> Holerite</a></li>
                <li><a href="/rh/folha-pagamento/descontos"><i class="fas fa-minus-circle"></i> Descontos</a></li>
                <li><a href="/rh/folha-pagamento/relatorios"><i class="fas fa-chart-bar"></i> Relatórios</a></li>
              </ul>
            </li>
            
            <!-- Benefícios - Todos os níveis gerenciais -->
            <li class="has-submenu" th:if="${isGerencial}">
              <a href="javascript:void(0);" class="submenu-toggle">
                <i class="fas fa-gift"></i> Benefícios <i class="fas fa-chevron-down submenu-icon"></i>
              </a>
              <ul class="submenu" style="display: none;">
                <li><a href="/rh/beneficios/plano-saude"><i class="fas fa-heartbeat"></i> Plano de Saúde</a></li>
                <li><a href="/rh/beneficios/vale-transporte"><i class="fas fa-bus"></i> Vale Transporte</a></li>
                <li><a href="/rh/beneficios/vale-refeicao"><i class="fas fa-utensils"></i> Vale Refeição</a></li>
                <li><a href="/rh/beneficios/adesao"><i class="fas fa-check-circle"></i> Adesão</a></li>
              </ul>
            </li>
            
            <!-- Ponto e Escalas -->
            <li class="has-submenu">
              <a href="javascript:void(0);" class="submenu-toggle">
                <i class="fas fa-clock"></i> Ponto e Escalas <i class="fas fa-chevron-down submenu-icon"></i>
              </a>
              <ul class="submenu" style="display: none;">
                <li><a href="/rh/ponto-escalas/registros"><i class="fas fa-fingerprint"></i> Registros</a></li>
                <li th:if="${isGerencial}"><a href="/rh/ponto-escalas/correcoes"><i class="fas fa-edit"></i> Correções</a></li>
                <li th:if="${isGerencial}"><a href="/rh/ponto-escalas/escalas"><i class="fas fa-calendar-alt"></i> Escalas</a></li>
                <li th:if="${podeGerenciarRH}"><a href="/rh/ponto-escalas/relatorios"><i class="fas fa-chart-line"></i> Relatórios</a></li>
              </ul>
            </li>
            
            <!-- Férias -->
            <li class="has-submenu">
              <a href="javascript:void(0);" class="submenu-toggle">
                <i class="fas fa-umbrella-beach"></i> Férias <i class="fas fa-chevron-down submenu-icon"></i>
              </a>
              <ul class="submenu" style="display: none;">
                <li><a href="/rh/ferias/solicitar"><i class="fas fa-paper-plane"></i> Solicitar</a></li>
                <li th:if="${isGerencial}"><a href="/rh/ferias/aprovar"><i class="fas fa-check"></i> Aprovar</a></li>
                <li th:if="${podeGerenciarRH}"><a href="/rh/ferias/planejamento"><i class="fas fa-calendar-check"></i> Planejamento</a></li>
                <li><a href="/rh/ferias/calendario"><i class="fas fa-calendar"></i> Calendário</a></li>
              </ul>
            </li>
            
            <!-- Avaliação -->
            <li class="has-submenu" th:if="${isGerencial}">
              <a href="javascript:void(0);" class="submenu-toggle">
                <i class="fas fa-star"></i> Avaliação <i class="fas fa-chevron-down submenu-icon"></i>
              </a>
              <ul class="submenu" style="display: none;">
                <li><a href="/rh/avaliacao/periodicidade"><i class="fas fa-calendar-week"></i> Periodicidade</a></li>
                <li><a href="/rh/avaliacao/feedbacks"><i class="fas fa-comments"></i> Feedbacks</a></li>
                <li th:if="${podeGerenciarRH}"><a href="/rh/avaliacao/relatorios"><i class="fas fa-chart-pie"></i> Relatórios</a></li>
              </ul>
            </li>
            
            <!-- Treinamentos -->
            <li class="has-submenu">
              <a href="javascript:void(0);" class="submenu-toggle">
                <i class="fas fa-graduation-cap"></i> Treinamentos <i class="fas fa-chevron-down submenu-icon"></i>
              </a>
              <ul class="submenu" style="display: none;">
                <li th:if="${podeGerenciarRH}"><a href="/rh/treinamentos/cadastro"><i class="fas fa-plus-square"></i> Cadastro</a></li>
                <li><a href="/rh/treinamentos/inscricao"><i class="fas fa-user-plus"></i> Inscrição</a></li>
                <li><a href="/rh/treinamentos/certificado"><i class="fas fa-certificate"></i> Certificado</a></li>
              </ul>
            </li>
            
            <!-- Recrutamento - Apenas RH -->
            <li class="has-submenu" th:if="${podeGerenciarRH}">
              <a href="javascript:void(0);" class="submenu-toggle">
                <i class="fas fa-search"></i> Recrutamento <i class="fas fa-chevron-down submenu-icon"></i>
              </a>
              <ul class="submenu" style="display: none;">
                <li><a href="/rh/recrutamento/vagas"><i class="fas fa-briefcase"></i> Vagas</a></li>
                <li><a href="/rh/recrutamento/triagem"><i class="fas fa-filter"></i> Triagem</a></li>
                <li><a href="/rh/recrutamento/entrevistas"><i class="fas fa-handshake"></i> Entrevistas</a></li>
                <li><a href="/rh/recrutamento/historico"><i class="fas fa-history"></i> Histórico</a></li>
              </ul>
            </li>
            
            <!-- Relatórios RH - Apenas RH -->
            <li class="has-submenu" th:if="${podeGerenciarRH}">
              <a href="javascript:void(0);" class="submenu-toggle">
                <i class="fas fa-chart-bar"></i> Relatórios RH <i class="fas fa-chevron-down submenu-icon"></i>
              </a>
              <ul class="submenu" style="display: none;">
                <li><a href="/rh/relatorios/turnover"><i class="fas fa-exchange-alt"></i> Turnover</a></li>
                <li><a href="/rh/relatorios/absenteismo"><i class="fas fa-user-times"></i> Absenteísmo</a></li>
                <li><a href="/rh/relatorios/headcount"><i class="fas fa-users"></i> Headcount</a></li>
                <li><a href="/rh/relatorios/indicadores"><i class="fas fa-tachometer-alt"></i> Indicadores</a></li>
              </ul>
            </li>
          </ul>
        </li>

        <!-- Itens financeiros - Baseado em permissões -->
        <li th:if="${podeAcessarFinanceiro}"><a href="/contas-pagar"><i class="fas fa-money-check-alt"></i> Contas a Pagar</a></li>
        <li th:if="${podeAcessarFinanceiro}"><a href="/contas-receber"><i class="fas fa-file-invoice-dollar"></i> Contas a Receber</a></li>

        <!-- Itens operacionais -->
        <li><a href="/servicos"><i class="fas fa-tools"></i> Serviços</a></li>
        <li><a href="/agenda"><i class="fas fa-calendar-check"></i> Agenda</a></li>

        <!-- Seção Administrativa - Baseada em permissões específicas -->
        <li th:if="${podeGerenciarUsuarios}"><a href="/usuarios/index"><i class="fas fa-user-friends"></i> Usuários</a></li>
        <li th:if="${isAdmin or isMaster}"><a href="/permissoes"><i class="fas fa-user-shield"></i> Perfis e Permissões</a></li>
        <li th:if="${podeAcessarFinanceiro}"><a href="/financeiro"><i class="fas fa-wallet"></i> Financeiro</a></li>
        <li th:if="${isGerencial}"><a href="/relatorios"><i class="fas fa-chart-pie"></i> Relatórios</a></li>
        <li th:if="${isAdmin or isMaster}"><a href="/configuracoes"><i class="fas fa-cogs"></i> Configurações</a></li>
        <li th:if="${isGerencial}"><a href="/metas"><i class="fas fa-bullseye"></i> Metas</a></li>
        <li th:if="${podeAcessarFinanceiro}"><a href="/transferencias"><i class="fas fa-exchange-alt"></i> Transferências</a></li>

        <!-- Itens para usuários não gerenciais -->
        <li th:if="${!isGerencial}"><a href="/chat"><i class="fas fa-comments"></i> Chat</a></li>
        <li th:if="${!isGerencial}"><a href="/ajuda"><i class="fas fa-question-circle"></i> Central de Ajuda</a></li>
        <li th:if="${!isGerencial}"><a href="/termos"><i class="fas fa-file-contract"></i> Termos de Uso</a></li>
        <li th:if="${!isGerencial}"><a href="/meus-pedidos"><i class="fas fa-clipboard-list"></i> Meus Pedidos</a></li>
        <li th:if="${!isGerencial}"><a href="/meus-servicos"><i class="fas fa-concierge-bell"></i> Meus Serviços</a></li>
        <li th:if="${!isGerencial}"><a href="/favoritos"><i class="fas fa-star"></i> Favoritos</a></li>
        <li th:if="${!isGerencial}"><a href="/recomendacoes"><i class="fas fa-thumbs-up"></i> Recomendados</a></li>
        
        <!-- Documentos e Suporte - Acesso diferenciado -->
        <li th:if="${isGerencial}"><a href="/documentos"><i class="fas fa-file-alt"></i> Documentos Gerenciais</a></li>
        <li th:if="${!isGerencial}"><a href="/documentos"><i class="fas fa-file-alt"></i> Meus Documentos</a></li>
        <li><a href="/suporte"><i class="fas fa-life-ring"></i> Suporte</a></li>

        <!-- Logout sempre no fim -->
        <li><a href="/logout"><i class="fas fa-power-off"></i> Sair</a></li>
      </ul>
    </nav>
  </div>
  <script th:src="@{/js/sidebar.js}"></script>
</div>