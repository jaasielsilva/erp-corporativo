<!DOCTYPE html>
<html lang="pt-br" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title th:text="${pageTitle}">Campanha</title>

    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- FontAwesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">

    <!-- CSS custom -->
    <link href="/css/style.css" rel="stylesheet">
    <link href="/css/sidebar.css" rel="stylesheet">
    <link href="/css/notifications.css" rel="stylesheet">
</head>

<body>
    <!-- Verificação de permissão para acessar o módulo marketing -->
    <div th:if="${!podeAcessarMarketing}" class="container mt-5">
        <div class="alert alert-danger text-center">
            <h4><i class="fas fa-exclamation-triangle"></i> Acesso Negado</h4>
            <p>Você não tem permissão para acessar o módulo de marketing.</p>
            <a href="/" class="btn btn-primary">Voltar ao Dashboard</a>
        </div>
    </div>

    <div th:if="${podeAcessarMarketing}" class="app-container">

        <!-- Sidebar -->
        <aside th:replace="~{components/sidebar :: sidebar}"></aside>

        <!-- Main Content -->
        <main class="main-content">

            <!-- Topbar -->
            <header th:replace="~{components/topbar :: topbar}"></header>

            <!-- Conteúdo -->
            <section class="content-area container-fluid py-4">
                <div class="container">
                    <h2 class="mb-4" th:text="${pageTitle}"></h2>

                    <form th:action="@{/marketing/campanhas/salvar}" th:object="${campanha}" method="post">

                        <input type="hidden" th:field="*{id}" />

                        <!-- Nome -->
                        <div class="mb-3">
                            <label for="nome" class="form-label">Nome da Campanha</label>
                            <input type="text" th:field="*{nome}" class="form-control" id="nome"
                                placeholder="Digite o nome" required>
                            <div class="text-danger" th:if="${#fields.hasErrors('nome')}" th:errors="*{nome}"></div>
                        </div>

                        <!-- Descrição -->
                        <div class="mb-3">
                            <label for="descricao" class="form-label">Descrição</label>
                            <textarea th:field="*{descricao}" class="form-control" id="descricao" rows="3"></textarea>
                        </div>

                        <!-- Tipo (enum) -->
                        <div class="mb-3">
                            <label for="tipo" class="form-label">Tipo de Campanha</label>
                            <select th:field="*{tipo}" class="form-select" id="tipo" required>
                                <option value="" disabled>Selecione um tipo</option>
                                <option th:each="t : ${tipoOptions}" th:value="${t}" th:text="${t.descricao}"></option>
                            </select>
                        </div>

                        <!-- Objetivo (enum) -->
                        <div class="mb-3">
                            <label for="objetivo" class="form-label">Objetivo</label>
                            <select th:field="*{objetivo}" class="form-select" id="objetivo" required>
                                <option value="" disabled>Selecione um objetivo</option>
                                <option th:each="o : ${objetivoOptions}" th:value="${o}" th:text="${o.descricao}">
                                </option>
                            </select>
                        </div>

                        <!-- Datas -->
                        <div class="row mb-3">
                            <div class="col">
                                <label for="dataInicio" class="form-label">Data Início</label>
                                <input type="date" th:field="*{dataInicio}" class="form-control" id="dataInicio"
                                    required>
                            </div>
                            <div class="col">
                                <label for="dataFim" class="form-label">Data Fim</label>
                                <input type="date" th:field="*{dataFim}" class="form-control" id="dataFim">
                            </div>
                        </div>

                        <!-- Orçamento -->
                        <div class="mb-3">
                            <label for="orcamentoPlanejado" class="form-label">Orçamento Planejado</label>
                            <input type="number" step="0.01" th:field="*{orcamentoPlanejado}" class="form-control"
                                id="orcamentoPlanejado">
                        </div>

                        <!-- Responsável (usuário) -->
                        <div class="mb-3">
                            <label for="usuarioResponsavel" class="form-label">Responsável</label>
                            <select th:field="*{usuarioResponsavel.id}" class="form-select" id="usuarioResponsavel"
                                required>
                                <option value="" disabled>Selecione um responsável</option>
                                <option th:each="u : ${usuarios}" th:value="${u.id}" th:text="${u.nome}"></option>
                            </select>
                        </div>

                        <!-- Botões -->
                        <button type="submit" class="btn btn-primary"><i class="fas fa-save"></i> Salvar</button>
                        <a th:href="@{/marketing/campanhas}" class="btn btn-secondary"><i class="fas fa-arrow-left"></i>
                            Voltar</a>
                        </form>

                </div>
            </section>

            <!-- Footer -->
            <footer th:replace="~{components/footer :: footer}"></footer>
        </main>
    </div>
    <!-- Fim da verificação de permissão -->

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
    <script src="/js/sidebar.js" defer></script>
    <script th:src="@{/js/notifications.js}"></script>
</body>

</html>