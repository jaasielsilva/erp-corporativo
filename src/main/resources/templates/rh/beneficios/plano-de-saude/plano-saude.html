<!DOCTYPE html>
<html lang="pt-br" xmlns:th="http://www.thymeleaf.org">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Plano de Saúde - ERP Corporativo</title>
  <link href="/css/style.css" rel="stylesheet">
  <link href="/css/sidebar.css" rel="stylesheet">
  <link href="/css/notifications.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
  <link rel="stylesheet" th:href="@{/css/plano-de-saude.css}" />
</head>

<body>
  <div class="app-container">
    <aside th:replace="~{components/sidebar :: sidebar}"></aside>

    <main class="main-content">
      <header th:replace="~{components/topbar :: topbar}"></header>

      <section class="content-area">
        <h1>Plano de Saúde</h1>
        <h2>Gerenciamento de planos de saúde dos colaboradores</h2>

        <!-- Resumo dos Planos -->
        <article class="card">
          <h3><i class="fas fa-chart-pie"></i> Resumo dos Planos</h3>
          <div class="resumo-planos">
            <div class="resumo-grid">
              <div class="resumo-item total">
                <div class="resumo-icon">
                  <i class="fas fa-users"></i>
                </div>
                <div class="resumo-info">
                  <h4>Total de Beneficiários</h4>
                  <div class="resumo-valor" th:text="${totalBeneficiarios}">0</div>
                  <div class="resumo-detalhes"
                    th:text="${titulares} + ' titulares + ' + ${dependentes} + ' dependentes'">
                    0 titulares + 0 dependentes
                  </div>
                </div>


              </div>

              <div class="resumo-item custo">
                <div class="resumo-icon">
                  <i class="fas fa-money-bill-wave"></i>
                </div>
                <div class="resumo-info">
                  <h4>Custo Mensal</h4>
                  <div class="resumo-valor"
                    th:text="'R$ ' + ${#numbers.formatDecimal(custoMensal, 0, 'POINT', 2, 'COMMA')}">
                    R$ 0,00
                  </div>
                  <div class="resumo-detalhes">Empresa + Colaboradores</div>
                </div>


              </div>

              <div class="resumo-item empresa">
                <div class="resumo-icon">
                  <i class="fas fa-building"></i>
                </div>
                <div class="resumo-info">
                  <h4>Custo Empresa</h4>
                  <div class="resumo-valor"
                    th:text="'R$ ' + ${#numbers.formatDecimal(custoEmpresa, 0, 'POINT', 2, 'COMMA')}">
                    R$ 0,00
                  </div>
                  <div class="resumo-detalhes">Empresa (titular 80%)</div>
                </div>

              </div>

              <div class="resumo-item colaborador">
                <div class="resumo-icon">
                  <i class="fas fa-user"></i>
                </div>
                <!-- Desconto Colaboradores -->
                <div class="resumo-info">
                  <h4>Desconto Colaboradores</h4>
                  <div class="resumo-valor"
                    th:text="'R$ ' + ${#numbers.formatDecimal(descontoColaboradores, 0, 'POINT', 2, 'COMMA')}">
                    R$ 0,00
                  </div>
                  <div class="resumo-detalhes">Colaboradores (titular 20% + dependentes 100%)</div>
                </div>

              </div>
            </div>
          </div>
        </article>

        </article>
        <!-- Planos Disponíveis -->
        <article class="card">
          <h3><i class="fas fa-clipboard-list"></i> Planos Disponíveis</h3>
          <div class="planos-disponiveis">
            <div class="planos-grid">

              <!-- Iterar dinamicamente pelos planos -->
              <div th:each="plano, iterStat : ${planos}" 
                   th:class="'plano-card ' + ${plano.tipo.name().toLowerCase()}">
                <div class="plano-header">
                  <h4>
                    <i class="fas fa-shield-alt" th:if="${plano.tipo.name() == 'BASICO'}"></i>
                    <i class="fas fa-shield-alt" th:if="${plano.tipo.name() == 'INTERMEDIARIO'}"></i>
                    <i class="fas fa-crown" th:if="${plano.tipo.name() == 'PREMIUM'}"></i>
                    <i class="fas fa-crown" th:if="${plano.tipo.name() == 'EXECUTIVO'}"></i>
                    <span th:text="${plano.nome}">Nome do Plano</span>
                  </h4>
                  <div class="plano-preco">
                    <span th:text="'R$ ' + ${#numbers.formatDecimal(plano.valorTitular, 0, 'POINT', 2, 'COMMA')} + '/mês'">R$ 0,00/mês</span>
                  </div>
                </div>

                <div class="plano-beneficios">
                  <ul>
                    <li><i class="fas fa-check"></i> Consultas médicas</li>
                    <li><i class="fas fa-check"></i> 
                      <span th:if="${plano.tipo.name() == 'BASICO'}">Exames básicos</span>
                      <span th:if="${plano.tipo.name() != 'BASICO'}">Exames completos</span>
                    </li>
                    <li><i class="fas fa-check"></i> Emergência 24h</li>
                    <li>
                      <i th:class="${plano.tipo.name() == 'BASICO'} ? 'fas fa-times' : 'fas fa-check'"></i>
                      Cirurgias eletivas
                    </li>
                    <li>
                      <i th:class="${plano.tipo.name() == 'PREMIUM' || plano.tipo.name() == 'EXECUTIVO'} ? 'fas fa-check' : 'fas fa-times'"></i>
                      Quarto privativo
                    </li>
                  </ul>
                </div>
                <div class="plano-operadoras">
                  <small th:text="'Disponível: ' + ${plano.operadora}">Disponível: Operadora</small>
                </div>
              </div>

            </div>
          </div>
        </article>

      </section>

      <footer th:replace="~{components/footer :: footer}"></footer>
    </main>
  </div>

  <!-- Modal Nova Adesão -->
  <div id="modalAdesao" class="modal" style="display: none;">
    <div class="modal-content large">
      <div class="modal-header">
        <h3><i class="fas fa-plus"></i> Nova Adesão ao Plano de Saúde</h3>
        <button onclick="fecharModalAdesao()" class="btn-close">
          <i class="fas fa-times"></i>
        </button>
      </div>

      <form class="modal-body">
        <div class="form-row">
          <div class="form-group">
            <label for="colaboradorAdesao">Colaborador *</label>
            <select id="colaboradorAdesao" name="colaborador" required class="form-control">
              <option value="">Selecione um colaborador...</option>
              <option value="4">Ana Costa - Designer</option>
              <option value="5">Pedro Lima - Analista Marketing</option>
              <option value="6">Lucia Fernandes - Assistente RH</option>
            </select>
          </div>
          <div class="form-group">
            <label for="operadoraAdesao">Operadora *</label>
            <select id="operadoraAdesao" name="operadora" required class="form-control">
              <option value="">Selecione a operadora...</option>
              <option value="unimed">Unimed</option>
              <option value="bradesco">Bradesco Saúde</option>
              <option value="amil">Amil</option>
              <option value="sulamerica">SulAmérica</option>
            </select>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="tipoPlanoAdesao">Tipo de Plano *</label>
            <select id="tipoPlanoAdesao" name="tipoPlano" required class="form-control">
              <option value="">Selecione o plano...</option>
              <option value="basico">Básico - R$ 180,00</option>
              <option value="intermediario">Intermediário - R$ 320,00</option>
              <option value="premium">Premium - R$ 580,00</option>
            </select>
          </div>
          <div class="form-group">
            <label for="dataInicioAdesao">Data de Início *</label>
            <input type="date" id="dataInicioAdesao" name="dataInicio" required class="form-control">
          </div>
        </div>

        <div class="form-group">
          <label>
            <input type="checkbox" id="incluirDependentes" name="incluirDependentes" onchange="toggleDependentes()">
            Incluir dependentes
          </label>
        </div>

        <div id="dependentesSection" style="display: none;">
          <h4><i class="fas fa-users"></i> Dependentes</h4>
          <div id="dependentesList">
            <div class="dependente-item">
              <div class="form-row">
                <div class="form-group">
                  <label>Nome do Dependente</label>
                  <input type="text" name="dependente_nome[]" class="form-control" placeholder="Nome completo">
                </div>
                <div class="form-group">
                  <label>Parentesco</label>
                  <select name="dependente_parentesco[]" class="form-control">
                    <option value="">Selecione...</option>
                    <option value="conjuge">Cônjuge</option>
                    <option value="filho">Filho(a)</option>
                    <option value="pai">Pai</option>
                    <option value="mae">Mãe</option>
                  </select>
                </div>
                <div class="form-group">
                  <label>Data de Nascimento</label>
                  <input type="date" name="dependente_nascimento[]" class="form-control">
                </div>
                <div class="form-group">
                  <button type="button" onclick="removerDependente(this)" class="btn btn-danger btn-sm">
                    <i class="fas fa-trash"></i>
                  </button>
                </div>
              </div>
            </div>
          </div>
          <button type="button" onclick="adicionarDependente()" class="btn btn-secondary btn-sm">
            <i class="fas fa-plus"></i> Adicionar Dependente
          </button>
        </div>

        <div class="form-group">
          <label for="observacoesAdesao">Observações</label>
          <textarea id="observacoesAdesao" name="observacoes" class="form-control" rows="3"
            placeholder="Informações adicionais sobre a adesão..."></textarea>
        </div>
      </form>

      <div class="modal-footer">
        <button type="button" onclick="fecharModalAdesao()" class="btn btn-secondary">
          <i class="fas fa-times"></i> Cancelar
        </button>
        <button type="button" onclick="salvarAdesao()" class="btn btn-primary">
          <i class="fas fa-save"></i> Salvar Adesão
        </button>
      </div>
    </div>
  </div>


  <script th:src="@{/js/sidebar.js}"></script>
  <!-- Script de notifica��es --> <!-- jQuery necess�rio para o sistema de notifica��es -->
  <script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>



  <script th:src="@{/js/notifications.js}"></script>
</body>

</html>