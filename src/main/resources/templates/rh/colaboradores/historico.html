<!DOCTYPE html>
<html lang="pt-br" xmlns:th="http://www.thymeleaf.org">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Histórico do Colaborador - ERP Corporativo</title>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet" />
  <link rel="stylesheet" th:href="@{/css/style.css}" />
  <link rel="stylesheet" th:href="@{/css/sidebar.css}" />
</head>

<body>
  <div class="app-container">
    <aside th:replace="~{components/sidebar :: sidebar}"></aside>

    <main class="main-content">
      <header th:replace="~{components/topbar :: topbar}"></header>

      <section class="content-area">
        <h1>Histórico do Colaborador</h1>
        <h2 th:text="${colaborador.nome} + ' - ' + ${colaborador.cargo.nome}">João Silva - Desenvolvedor Senior</h2>

        <div class="action-buttons">
          <a href="/rh/colaboradores/listar" class="btn btn-secondary">
            <i class="fas fa-arrow-left"></i> Voltar à Lista
          </a>
          <a th:href="@{'/rh/colaboradores/ficha/' + ${colaborador.id}}" class="btn btn-info">
            <i class="fas fa-eye"></i> Ver Ficha
          </a>
          <button onclick="exportarHistorico()" class="btn btn-success">
            <i class="fas fa-file-export"></i> Exportar Histórico
          </button>
        </div>

        <!-- Filtros -->
        <div class="filters">
          <select class="filter-select">
            <option value="">Todos os tipos</option>
            <option value="promocao">Promoções</option>
            <option value="transferencia">Transferências</option>
            <option value="ferias">Férias</option>
            <option value="licenca">Licenças</option>
            <option value="treinamento">Treinamentos</option>
            <option value="avaliacao">Avaliações</option>
            <option value="disciplinar">Ações Disciplinares</option>
          </select>
          <input type="date" class="filter-date" placeholder="Data inicial">
          <input type="date" class="filter-date" placeholder="Data final">
          <button class="btn btn-primary">Filtrar</button>
        </div>

        <!-- Timeline do Histórico -->
        <div class="historico-timeline">
          <div th:each="item : ${historico}" class="timeline-item" th:classappend="${#strings.toLowerCase(item.evento)}">
            <div class="timeline-marker">
              <i th:class="${
                item.evento == 'Promoção' ? 'fas fa-arrow-up' :
                item.evento == 'Avaliação' ? 'fas fa-star' :
                item.evento == 'Treinamento' ? 'fas fa-graduation-cap' :
                item.evento == 'Férias' ? 'fas fa-umbrella-beach' :
                item.evento == 'Admissão' ? 'fas fa-user-plus' :
                item.evento == 'Transferência' ? 'fas fa-exchange-alt' :
                'fas fa-info-circle'
              }"></i>
            </div>
            <div class="timeline-content">
              <div class="timeline-header">
                <h4 th:text="${item.evento + (item.cargoNovo != null ? ' para ' + item.cargoNovo : '')}">Evento</h4>
                <span class="timeline-date" th:text="${#temporals.format(item.dataRegistro, 'dd/MM/yyyy')}">Data</span>
              </div>
              <p th:text="${item.descricao}">Descrição do evento</p>
              <div class="timeline-details" th:if="${item.salarioAnterior != null or item.salarioNovo != null or item.cargoAnterior != null or item.departamentoAnterior != null}">
                <span th:if="${item.salarioAnterior != null}" class="detail-item"><strong>Salário anterior:</strong> <span th:text="'R$ ' + ${#numbers.formatDecimal(item.salarioAnterior, 1, 'COMMA', 2, 'POINT')}">R$ 0,00</span></span>
                <span th:if="${item.salarioNovo != null}" class="detail-item"><strong>Novo salário:</strong> <span th:text="'R$ ' + ${#numbers.formatDecimal(item.salarioNovo, 1, 'COMMA', 2, 'POINT')}">R$ 0,00</span></span>
                <span th:if="${item.cargoAnterior != null}" class="detail-item"><strong>Cargo anterior:</strong> <span th:text="${item.cargoAnterior}">Cargo</span></span>
                <span th:if="${item.departamentoAnterior != null and item.departamentoNovo != null and item.departamentoAnterior != item.departamentoNovo}" class="detail-item"><strong>Departamento:</strong> <span th:text="${item.departamentoAnterior + ' → ' + item.departamentoNovo}">Departamento</span></span>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Mensagem quando não há histórico -->
        <div th:if="${#lists.isEmpty(historico)}" class="historico-timeline">
          <div class="timeline-item">
            <div class="timeline-marker">
              <i class="fas fa-info-circle"></i>
            </div>
            <div class="timeline-content">
               <div class="timeline-header">
                 <h4>Nenhum histórico encontrado</h4>
                 <span class="timeline-date">-</span>
               </div>
               <p>Este colaborador ainda não possui registros no histórico.</p>
             </div>
           </div>
         </div>

        <!-- Resumo Estatístico -->
        <article class="card">
          <h3><i class="fas fa-chart-bar"></i> Resumo Estatístico</h3>
          <div class="stats-grid">
            <div class="stat-card">
              <div class="stat-icon">
                <i class="fas fa-calendar-alt"></i>
              </div>
              <div class="stat-info">
                <h4>Tempo na Empresa</h4>
                <p>1 ano e 8 meses</p>
              </div>
            </div>
            <div class="stat-card">
              <div class="stat-icon">
                <i class="fas fa-arrow-up"></i>
              </div>
              <div class="stat-info">
                <h4>Promoções</h4>
                <p>2 promoções</p>
              </div>
            </div>
            <div class="stat-card">
              <div class="stat-icon">
                <i class="fas fa-graduation-cap"></i>
              </div>
              <div class="stat-info">
                <h4>Treinamentos</h4>
                <p>3 concluídos</p>
              </div>
            </div>
            <div class="stat-card">
              <div class="stat-icon">
                <i class="fas fa-star"></i>
              </div>
              <div class="stat-info">
                <h4>Média de Avaliações</h4>
                <p>9.3/10</p>
              </div>
            </div>
          </div>
        </article>
      </section>

      <footer th:replace="~{components/footer :: footer}"></footer>
    </main>
  </div>

  <script th:src="@{/js/script.js}"></script>
  <script>
    function exportarHistorico() {
      alert('Funcionalidade de exportação será implementada.');
    }
  </script>
  <!-- Script de notifica��es -->  <!-- jQuery necess�rio para o sistema de notifica��es -->
  <script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>



  <script th:src="@{/js/notifications.js}"></script>
  <!-- jQuery necess�rio para o sistema de notifica��es -->
  <script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
  
  <!-- Script de notifica��es -->  <!-- jQuery necess�rio para o sistema de notifica��es -->
  <script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>



  <script th:src="@{/js/notifications.js}"></script>
  <script th:src="@{/js/sidebar.js}"></script>

</body>

</html>
