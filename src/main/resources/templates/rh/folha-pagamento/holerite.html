<!DOCTYPE html>
<html lang="pt-br" xmlns:th="http://www.thymeleaf.org">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Holerites - ERP Corporativo</title>
  <meta th:if="${periodoReferencia != null}" th:attr="content=${'Holerite - ' + periodoReferencia}" name="title" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet" th:if="${pdf == null}" />
  <link rel="stylesheet" th:href="@{/css/style.css}" th:if="${pdf == null}" />
  <link rel="stylesheet" th:href="@{/css/sidebar.css}" th:if="${pdf == null}" />
  <style>
    .holerite-container {
      max-width: 800px;
      margin: 0 auto;
      background: white;
      border: 1px solid #ddd;
      border-radius: 8px;
      overflow: hidden;
    }
    
    .holerite-header {
      background: #f8f9fa;
      padding: 20px;
      border-bottom: 2px solid #007bff;
    }
    
    .empresa-info {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 15px;
    }
    
    .empresa-logo {
      font-size: 24px;
      font-weight: bold;
      color: #007bff;
    }
    
    .periodo-info {
      text-align: right;
      font-size: 14px;
      color: #666;
    }
    
    .funcionario-info {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin-top: 15px;
    }
    
    .holerite-body {
      padding: 20px;
    }
    
    .tabela-holerite {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 20px;
      font-size: 14px;
    }
    
    .tabela-holerite th, .tabela-holerite td {
      border: 1px solid #dee2e6;
      padding: 8px 12px;
    }
    
    .tabela-holerite th {
      background: #f8f9fa;
      font-weight: bold;
      text-transform: uppercase;
      font-size: 12px;
      color: #666;
      text-align: left;
    }
    
    .tabela-holerite .col-ref {
      text-align: center;
      width: 80px;
    }
    
    .tabela-holerite .col-valor {
      text-align: right;
      width: 130px;
    }
    
    .tabela-holerite .total-row {
      background: #e9ecef;
      font-weight: bold;
    }
    
    .liquido-box {
      background: #e3f2fd;
      border: 1px solid #2196f3;
      padding: 15px;
      border-radius: 4px;
      text-align: right;
      font-size: 16px;
      font-weight: bold;
      color: #0d47a1;
      margin-top: 20px;
    }
    
    .holerite-footer {
      background: #f8f9fa;
      padding: 15px 20px;
      border-top: 1px solid #dee2e6;
      font-size: 12px;
      color: #666;
      text-align: center;
    }
    
    .print-actions {
      margin-bottom: 20px;
      text-align: center;
    }
    
    @media print {
      .print-actions, .sidebar, .topbar, .action-buttons {
        display: none !important;
      }
      
      .main-content {
        margin-left: 0 !important;
      }
      
      .content-area {
        padding: 0 !important;
      }
      
      .holerite-container {
        box-shadow: none;
        border: 1px solid #000;
        max-width: 100%;
        margin: 0;
      }
    }
  </style>
</head>

<body>
  <div class="app-container">
    <aside th:replace="~{components/sidebar :: sidebar}" th:if="${pdf == null}"></aside>

    <main class="main-content">
      <header th:replace="~{components/topbar :: topbar}" th:if="${pdf == null}"></header>

      <section class="content-area">
        <h1>Holerite</h1>
        <h2 th:text="${periodoReferencia}"></h2>

        <div class="action-buttons" th:if="${pdf == null}">
          <a th:href="@{/rh/folha-pagamento}" class="btn btn-secondary">
            <i class="fas fa-arrow-left"></i> Voltar
          </a>
          <a th:href="@{/rh/folha-pagamento/relatorios}" class="btn btn-info">
            <i class="fas fa-chart-bar"></i> Relatórios
          </a>
        </div>

        <!-- Filtros -->
        <article class="card" th:if="${pdf == null}">
          <h3><i class="fas fa-filter"></i> Filtros</h3>
          <form class="form-container">
            <div class="form-row">
              <div class="form-group">
                <label for="colaboradorSelect">Colaborador</label>
                <select id="colaboradorSelect" name="colaborador" class="form-control" onchange="carregarHolerite()">
                  <option value="">Selecione um colaborador...</option>
                  <option value="1" selected>João Silva - Desenvolvedor Senior</option>
                  <option value="2">Maria Santos - Analista de Vendas</option>
                  <option value="3">Carlos Oliveira - Gerente Financeiro</option>
                  <option value="4">Ana Costa - Designer</option>
                  <option value="5">Pedro Lima - Analista de Marketing</option>
                </select>
              </div>
              <div class="form-group">
                <label for="mesAno">Mês/Ano</label>
                <select id="mesAno" name="mesAno" class="form-control" onchange="carregarHolerite()">
                  <option value="11/2023" selected>Novembro/2023</option>
                  <option value="10/2023">Outubro/2023</option>
                  <option value="09/2023">Setembro/2023</option>
                  <option value="08/2023">Agosto/2023</option>
                </select>
              </div>
            </div>
          </form>
        </article>

        <!-- Ações de Impressão -->
        <div class="print-actions" th:if="${pdf == null}">
          <button id="btn-print" onclick="window.print()" class="btn btn-primary">
            <i class="fas fa-print"></i> Imprimir Holerite
          </button>
          <a id="btn-pdf" th:href="@{/rh/folha-pagamento/holerite/{id}/pdf(id=${holerite.id})}" class="btn btn-sm btn-success" onclick="baixarPDF()">
            <i class="fas fa-file-pdf"></i> Baixar PDF
          </a>
          <button id="btn-email" onclick="enviarEmail()" class="btn btn-info">
            <i class="fas fa-envelope"></i> Enviar por Email
          </button>
        </div>

        <!-- Holerite -->
        <div class="holerite-container" th:attr="data-holerite-id=${holerite.id}">
          <!-- Cabeçalho -->
          <div class="holerite-header">
            <div class="empresa-info">
              <div class="empresa-logo">
                <i class="fas fa-building"></i> ERP CORPORATIVO LTDA
              </div>
              <div class="periodo-info">
                <strong>HOLERITE</strong><br>
                Competência: <span th:text="${periodoReferencia}"></span><br>
                Emitido em: <span th:text="${dataReferencia}"></span>
              </div>
            </div>
            
            <div class="funcionario-info">
              <div>
                <strong>Funcionário:</strong> <span th:text="${holerite.colaborador.nome}"></span><br>
                <strong>Cargo:</strong> <span th:text="${holerite.colaborador.cargo != null ? holerite.colaborador.cargo.nome : '-'}"></span><br>
                <strong>Departamento:</strong> <span th:text="${holerite.colaborador.departamento != null ? holerite.colaborador.departamento.nome : '-'}"></span><br>
                <strong>Admissão:</strong> <span th:text="${#temporals.format(holerite.colaborador.dataAdmissao, 'dd/MM/yyyy')}"></span>
              </div>
              <div>
                <strong>E-mail:</strong> <span th:text="${holerite.colaborador.email != null ? holerite.colaborador.email : '-'}"></span><br>
                <strong>CPF:</strong> <span th:text="${holerite.colaborador.cpf}"></span><br>
                <strong>Salário Base:</strong> <span th:text="${#numbers.formatCurrency(holerite.salarioBase)}"></span><br>
                <strong>Dias Trabalhados:</strong> <span th:text="${holerite.diasTrabalhados}"></span>
              </div>
            </div>
          </div>

          <!-- Corpo do Holerite -->
          <div class="holerite-body">
            <table class="tabela-holerite">
              <thead>
                <tr>
                  <th>Descrição</th>
                  <th class="col-ref">Ref.</th>
                  <th class="col-valor">Vencimentos</th>
                  <th class="col-valor">Descontos</th>
                </tr>
              </thead>
              <tbody>
                <!-- Salário Base -->
                <tr>
                  <td>Salário Base</td>
                  <td class="col-ref" th:text="${#numbers.formatDecimal(holerite.diasTrabalhados, 1, 'POINT', 2, 'COMMA')}">30,00</td>
                  <td class="col-valor" th:text="${#numbers.formatCurrency(holerite.salarioBase)}"></td>
                  <td class="col-valor"></td>
                </tr>
                <!-- Horas Extras -->
                <tr th:if="${holerite.hasHorasExtras()}">
                  <td>Horas Extras</td>
                  <td class="col-ref">-</td>
                  <td class="col-valor" th:text="${#numbers.formatCurrency(holerite.horasExtras)}"></td>
                  <td class="col-valor"></td>
                </tr>
                <!-- Férias -->
                <tr th:if="${holerite.isFerias()}">
                  <td>1/3 Constitucional (Férias)</td>
                  <td class="col-ref">-</td>
                  <td class="col-valor" th:text="${#numbers.formatCurrency(holerite.bonificacoes)}"></td>
                  <td class="col-valor"></td>
                </tr>
                <!-- Outros Proventos -->
                <tr th:if="${holerite.hasAdicionalNoturno()}">
                  <td>Adicional Noturno</td>
                  <td class="col-ref">-</td>
                  <td class="col-valor" th:text="${#numbers.formatCurrency(holerite.adicionalNoturno)}"></td>
                  <td class="col-valor"></td>
                </tr>
                <tr th:if="${holerite.hasComissoes()}">
                  <td>Comissões</td>
                  <td class="col-ref">-</td>
                  <td class="col-valor" th:text="${#numbers.formatCurrency(holerite.comissoes)}"></td>
                  <td class="col-valor"></td>
                </tr>
                <tr th:if="${holerite.hasAdicionalPericulosidade()}">
                  <td>Adicional Periculosidade</td>
                  <td class="col-ref">-</td>
                  <td class="col-valor" th:text="${#numbers.formatCurrency(holerite.adicionalPericulosidade)}"></td>
                  <td class="col-valor"></td>
                </tr>
                <tr th:if="${holerite.hasAdicionalInsalubridade()}">
                  <td>Adicional Insalubridade</td>
                  <td class="col-ref">-</td>
                  <td class="col-valor" th:text="${#numbers.formatCurrency(holerite.adicionalInsalubridade)}"></td>
                  <td class="col-valor"></td>
                </tr>
                <tr th:if="${holerite.hasBonificacoes() && !holerite.isFerias()}">
                  <td>Bonificações</td>
                  <td class="col-ref">-</td>
                  <td class="col-valor" th:text="${#numbers.formatCurrency(holerite.bonificacoes)}"></td>
                  <td class="col-valor"></td>
                </tr>
                
                <!-- Descontos -->
                <tr>
                  <td>INSS</td>
                  <td class="col-ref">-</td>
                  <td class="col-valor"></td>
                  <td class="col-valor" th:text="${#numbers.formatCurrency(holerite.descontoInss)}"></td>
                </tr>
                <tr>
                  <td>IRRF</td>
                  <td class="col-ref">-</td>
                  <td class="col-valor"></td>
                  <td class="col-valor" th:text="${#numbers.formatCurrency(holerite.descontoIrrf)}"></td>
                </tr>
                <tr>
                  <td>Plano de Saúde</td>
                  <td class="col-ref">-</td>
                  <td class="col-valor"></td>
                  <td class="col-valor" th:text="${#numbers.formatCurrency(holerite.descontoPlanoSaude)}"></td>
                </tr>
                <tr>
                  <td>Desconto VR</td>
                  <td class="col-ref">-</td>
                  <td class="col-valor"></td>
                  <td class="col-valor" th:text="${#numbers.formatCurrency(holerite.descontoValeRefeicao)}"></td>
                </tr>
                <tr>
                  <td>Desconto VT</td>
                  <td class="col-ref">-</td>
                  <td class="col-valor"></td>
                  <td class="col-valor" th:text="${#numbers.formatCurrency(holerite.descontoValeTransporte)}"></td>
                </tr>
                <tr th:if="${holerite.hasDescontoFaltas()}">
                   <td>Faltas</td>
                   <td class="col-ref" th:text="${holerite.faltas}"></td>
                   <td class="col-valor"></td>
                   <td class="col-valor" th:text="${#numbers.formatCurrency(holerite.descontoFaltas)}"></td>
                </tr>
                <tr th:if="${holerite.hasOutrosDescontos()}">
                   <td>Outros Descontos</td>
                   <td class="col-ref">-</td>
                   <td class="col-valor"></td>
                   <td class="col-valor" th:text="${#numbers.formatCurrency(holerite.outrosDescontos)}"></td>
                </tr>
              </tbody>
              <tfoot>
                <tr class="total-row">
                  <td colspan="2" style="text-align: right">TOTAIS</td>
                  <td class="col-valor" th:text="${#numbers.formatCurrency(
                    holerite.salarioBase
                      .add(holerite.horasExtras)
                      .add(holerite.adicionalNoturno)
                      .add(holerite.adicionalPericulosidade)
                      .add(holerite.adicionalInsalubridade)
                      .add(holerite.comissoes)
                      .add(#strings.toLowerCase(holerite.tipoFolha) == 'ferias' ? holerite.bonificacoes : 0)
                  )}"></td>
                  <td class="col-valor" th:text="${#numbers.formatCurrency(holerite.totalDescontos)}"></td>
                </tr>
              </tfoot>
            </table>

            <div class="liquido-box">
              Salário Líquido: <span th:text="${#numbers.formatCurrency(holerite.salarioLiquido)}"></span>
              <span style="font-size: 0.9em; font-weight: normal; color: #666; margin-left: 10px;">
                (<span th:text="${#numbers.formatDecimal(
                    holerite.salarioBase
                      .add(holerite.horasExtras)
                      .add(holerite.adicionalNoturno)
                      .add(holerite.adicionalPericulosidade)
                      .add(holerite.adicionalInsalubridade)
                      .add(holerite.comissoes)
                      .add(#strings.toLowerCase(holerite.tipoFolha) == 'ferias' ? holerite.bonificacoes : 0)
                , 1, 'POINT', 2, 'COMMA')}"></span> - 
                 <span th:text="${#numbers.formatDecimal(holerite.totalDescontos, 1, 'POINT', 2, 'COMMA')}"></span>)
              </span>
            </div>

            <!-- Informações Adicionais -->
            <div style="margin-top: 20px; padding: 15px; background: #f8f9fa; border-radius: 6px;">
              <h4 style="margin-bottom: 10px;"><i class="fas fa-info-circle"></i> Informações Adicionais</h4>
              <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; font-size: 14px;">
                <div>
                  <strong>Base INSS:</strong> <span th:text="${#numbers.formatCurrency(holerite.salarioBase.add(holerite.horasExtras).subtract(holerite.descontoFaltas))}"></span><br>
                  <strong>Base IRRF:</strong>
                  <span th:switch="${#strings.toLowerCase(holerite.tipoFolha)}">
                    <span th:case="'ferias'" th:text="${#numbers.formatCurrency(holerite.salarioBase.add(holerite.horasExtras).subtract(holerite.descontoFaltas).subtract(holerite.descontoInss).add(holerite.bonificacoes))}"></span>
                    <span th:case="*" th:text="${#numbers.formatCurrency(holerite.salarioBase.add(holerite.horasExtras).subtract(holerite.descontoFaltas).subtract(holerite.descontoInss))}"></span>
                  </span><br>
                  <strong>Depósito FGTS (8%):</strong>
                  <span th:switch="${#strings.toLowerCase(holerite.tipoFolha)}">
                    <span th:case="'ferias'" th:text="${#numbers.formatCurrency(holerite.salarioBase.add(holerite.horasExtras).subtract(holerite.descontoFaltas).add(holerite.bonificacoes).multiply(0.08))}"></span>
                    <span th:case="*" th:text="${#numbers.formatCurrency(holerite.salarioBase.add(holerite.horasExtras).subtract(holerite.descontoFaltas).multiply(0.08))}"></span>
                  </span>
                </div>
                <div>
                  <strong>Dependentes IR:</strong> <span th:text="${holerite.dependentes}">0</span><br>
                  <strong>Salário Família:</strong> R$ 0,00<br>
                  <strong>13º Proporcional:</strong> R$ 708,33
                  <br>
                  <strong>Benefícios não remuneratórios:</strong><br>
                  Subsídio VT (empresa): <span th:text="${#numbers.formatCurrency(holerite.valeTransporte)}"></span><br>
                  Subsídio VR (empresa): <span th:text="${#numbers.formatCurrency(holerite.valeRefeicao)}"></span><br>
                  Auxílio Saúde (subsídio empresa): <span th:text="${#numbers.formatCurrency(holerite.auxilioSaude)}"></span>
                </div>
              </div>
            </div>
          </div>

          <!-- Rodapé -->
          <div class="holerite-footer">
            <p><strong>ERP Corporativo Ltda</strong></p>
            <p>Rua das Empresas, 123 - Centro - São Paulo/SP - CEP: 01234-567</p>
            <p>Este documento foi gerado eletronicamente e é válido sem assinatura.</p>
          </div>
        </div>

        <article class="card" style="margin-top: 30px;" th:attr="data-folha-id=${holerite.folhaPagamento != null ? holerite.folhaPagamento.id : 0}" th:if="${pdf == null}">
          <h3><i class="fas fa-list"></i> Holerites Disponíveis</h3>
          <div class="action-buttons">
            <div class="search-box">
              <input id="buscarHoleriteFolha" type="text" placeholder="Buscar por nome" autocomplete="off" />
            </div>
          </div>
          <div id="holeritesLoading" class="loading" style="display:none"><i class="fas fa-spinner fa-spin"></i> Carregando...</div>
          <table class="table-list">
            <thead>
              <tr>
                <th>Colaborador</th>
                <th>Salário Base</th>
                <th>Proventos</th>
                <th>Descontos</th>
                <th>Líquido</th>
                <th>Ações</th>
              </tr>
            </thead>
            <tbody id="holeritesBody"></tbody>
          </table>
          <div id="holeritesPagination" class="pagination"></div>
        </article>
      </section>

      <footer th:replace="~{components/footer :: footer}" th:if="${pdf == null}"></footer>
    </main>
  </div>

  <script th:if="${pdf == null}" th:src="@{/js/script.js}"></script>
  <script th:if="${pdf == null}">
    function carregarHolerite() {
      const colaborador = document.getElementById('colaboradorSelect').value;
      const mesAno = document.getElementById('mesAno').value;
      
      if (colaborador && mesAno) {
        // Simular carregamento de dados
        console.log(`Carregando holerite para colaborador ${colaborador} - ${mesAno}`);
        // Aqui seria feita a requisição para carregar os dados do holerite
      }
    }
    
    function visualizarHolerite(id) {
      // Carregar dados do holerite específico
      console.log(`Visualizando holerite ${id}`);
      // Atualizar o holerite exibido
    }
    
    function baixarPDF(id) {
      const btn = document.getElementById('btn-pdf');
      const targetId = id || document.querySelector('[data-holerite-id]')?.getAttribute('data-holerite-id');
      if (!targetId) {
        alert('Holerite não identificado.');
        return;
      }
      if (btn) {
        btn.classList.add('disabled');
        btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Gerando PDF...';
      }
      // Navegação padrão para download (Content-Disposition: attachment)
      window.location.href = `/rh/folha-pagamento/holerite/${targetId}/pdf`;
      // Reverter estado depois de pequeno atraso (navegação troca de página normalmente)
      setTimeout(() => {
        if (btn) {
          btn.classList.remove('disabled');
          btn.innerHTML = '<i class="fas fa-file-pdf"></i> Baixar PDF';
        }
      }, 3000);
    }
    
    function enviarEmail(id) {
      const btn = document.getElementById('btn-email');
      const targetId = id || document.querySelector('.holerite-container')?.getAttribute('data-holerite-id');
      if (!targetId) {
        alert('Holerite não identificado.');
        return;
      }
      const email = prompt('Digite o email de destino (deixe vazio para usar o do colaborador):') || '';
      const params = new URLSearchParams();
      if (email) params.set('email', email);
      if (btn) {
        btn.classList.add('disabled');
        btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Enviando...';
      }
      fetch(`/rh/folha-pagamento/holerite/${targetId}/email`, {
        method: 'POST',
        headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
        body: params.toString()
      }).then(async (res) => {
        const text = await res.text();
        alert(text || (res.ok ? 'Holerite enviado.' : 'Falha ao enviar holerite por email'));
      }).catch(() => {
        alert('Erro de comunicação ao enviar email');
      }).finally(() => {
        if (btn) {
          btn.classList.remove('disabled');
          btn.innerHTML = '<i class="fas fa-envelope"></i> Enviar por Email';
        }
      });
    }
    
    let currentHoleritesPage = 0;
    let queryHolerites = '';
    let debounceHolerites;
    function showHoleritesLoading(show){
      const el = document.getElementById('holeritesLoading');
      if (el) el.style.display = show ? 'block' : 'none';
    }
    function formatCurrencyBr(v){
      try { return new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(v || 0); } catch { return 'R$ 0,00'; }
    }
    function renderHoleritesRows(items){
      const tbody = document.getElementById('holeritesBody');
      if (!tbody) return;
      tbody.innerHTML = '';
      if (!items || items.length === 0){
        tbody.innerHTML = '<tr><td colspan="6" class="text-center">Nenhum holerite encontrado</td></tr>';
        return;
      }
      const rows = items.map(h => {
        const id = h.id;
        const nome = h.nome || '-';
        const salBase = formatCurrencyBr(h.salarioBase);
        const prov = formatCurrencyBr(h.totalProventos);
        const desc = formatCurrencyBr(h.totalDescontos);
        const liq = formatCurrencyBr(h.salarioLiquido);
        return `<tr>
          <td>${nome}</td>
          <td>${salBase}</td>
          <td style="color:green">${prov}</td>
          <td style="color:red">${desc}</td>
          <td style="font-weight:bold">${liq}</td>
          <td>
            <a href="/rh/folha-pagamento/holerite/${id}" class="btn btn-sm btn-info" title="Visualizar"><i class="fas fa-eye"></i></a>
            <button onclick="baixarPDF(${id})" class="btn btn-sm btn-success" title="PDF"><i class="fas fa-file-pdf"></i></button>
            <button onclick="enviarEmail(${id})" class="btn btn-sm btn-primary" title="Email"><i class="fas fa-envelope"></i></button>
          </td>
        </tr>`;
      });
      tbody.innerHTML = rows.join('');
    }
    
    function renderHoleritesPagination(data) {
      const el = document.getElementById('holeritesPagination');
      if (!el) return;
      const totalPages = data.totalPages || 0;
      const totalElements = data.totalElements || 0;
      const page = data.currentPage || 0;
      const hasPrev = data.hasPrevious;
      const hasNext = data.hasNext;
      let html = '';
      html += `<span class="pagination-info">Página ${page + 1} de ${Math.max(totalPages, 1)} (${totalElements} registros)</span>`;
      html += hasPrev ? `<a class="btn btn-secondary" href="#" onclick="goToPage(${page - 1});return false;"><i class="fas fa-chevron-left"></i> Anterior</a>` : `<span class="btn btn-secondary disabled"><i class="fas fa-chevron-left"></i> Anterior</span>`;
      html += hasNext ? `<a class="btn btn-secondary" href="#" onclick="goToPage(${page + 1});return false;">Próxima <i class="fas fa-chevron-right"></i></a>` : `<span class="btn btn-secondary disabled">Próxima <i class="fas fa-chevron-right"></i></span>`;
      el.innerHTML = html;
    }

    function goToPage(p) { 
        carregarHoleritesDaFolha(Math.max(0, p), queryHolerites); 
    }

    function carregarHoleritesDaFolha(page = 0, q = '') {
      const folhaId = document.querySelector('[data-folha-id]')?.getAttribute('data-folha-id');
      if (!folhaId || folhaId == '0') return;
      
      currentHoleritesPage = page;
      showHoleritesLoading(true);
      
      const url = `/rh/folha-pagamento/api/folha/${folhaId}/holerites?page=${page}&size=10&q=${encodeURIComponent(q)}`;
      
      fetch(url)
        .then(r => r.json())
        .then(data => {
          renderHoleritesRows(data.content);
          renderHoleritesPagination(data);
        })
        .catch(err => {
            console.error(err);
            renderHoleritesRows([]);
        })
        .finally(() => showHoleritesLoading(false));
    }
    
    // Inicialização
    document.addEventListener('DOMContentLoaded', function() {
      const searchInput = document.getElementById('buscarHoleriteFolha');
      if (searchInput) {
        searchInput.addEventListener('input', function(e) {
          clearTimeout(debounceHolerites);
          queryHolerites = e.target.value;
          debounceHolerites = setTimeout(() => {
            currentHoleritesPage = 0;
            carregarHoleritesDaFolha(currentHoleritesPage, queryHolerites);
          }, 500);
        });
      }
      // Carregar lista inicial
      carregarHoleritesDaFolha(0);
    });
  </script>
</body>
</html>
